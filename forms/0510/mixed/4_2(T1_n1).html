<!doctype html>
<html>

<head>
    <title>Debate Pairwise Comparison</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.1/css/bootstrap.min.css"
        integrity="sha384-VCmXjywReHh4PwowAiWNagnWcLhlEJLA5buUprzK8rxFgeH0kww/aWY76TfkUoSX" crossorigin="anonymous">
    <link rel="stylesheet" href="/debate-evaluation/assets/css/base.css">
    
</head>

<body>
    <div class="jumbotron jumbotron-fluid bg-light">
        <div class="container">
            
<div class="container">
    <h1 class="text-center mb-4">Welcome to the Debate Evaluation!</h1>
    <hr class="my-4">

    <div class="mb-4">
        <p class="lead text-center">You'll be evaluating a debate where two sides discuss a topic. Your opinion matters - you'll vote how persuasive each side is in each stage. We will use your feedback to improve the debate quality.</p>
    </div>

    <div class="mb-5 card shadow">
        <div class="card-header bg-info text-white">
            <h4 class="mb-0">What to Expect:</h4>
        </div>
        <div class="card-body">
            <div class="row mb-3">
                <div class="col-md-4">
                    <div class="text-center mb-3">
                        <i class="fa fa-hourglass-start fa-3x text-primary"></i>
                        <h5 class="mt-2">Debate Structure</h5>
                    </div>
                    <p>The full debate includes:</p>
                    <ul>
                        <li><strong>Opening:</strong> 4 min audio per side</li>
                        <li><strong>Rebuttal:</strong> 4 min audio per side</li>
                        <li><strong>Closing:</strong> 2 min audio per side</li>
                    </ul>
                    <p>You'll evaluate a portion of this debate.</p>
                </div>
                <div class="col-md-4">
                    <div class="text-center mb-3">
                        <i class="fa fa-tasks fa-3x text-primary"></i>
                        <h5 class="mt-2">Your Evaluation Tasks</h5>
                    </div>
                    <p>For each stage, you'll:</p>
                    <ul>
                        <li>Rate the persuasiveness of each side's statements</li>
                        <li>Update your position after hearing each argument</li>
                        <li>Provide optional feedback</li>
                    </ul>
                </div>
                <div class="col-md-4">
                    <div class="text-center mb-3">
                        <i class="fa fa-random fa-3x text-primary"></i>
                        <h5 class="mt-2">Final Comparison</h5>
                    </div>
                    <p>In the final stage:</p>
                    <ul>
                        <li>You'll see <strong>two versions</strong> of each side's closing statement</li>
                        <li>Rate each version independently</li>
                        <li>Select which version you found more persuasive</li>
                    </ul>
                </div>
            </div>
            <div class="alert alert-success">
                <strong>Important:</strong> Before beginning, you'll vote for the side you initially support. After each stage, you'll have the opportunity to reconsider and update your position based on the arguments presented.
                <hr>
                <strong>Note:</strong> Throughout the evaluation, you'll encounter <strong>attention check questions</strong> to ensure data quality. Participants who demonstrate thoughtful engagement will receive compensation as agreed. If you're unable to commit to providing quality responses, you may exit the survey at any time without penalty.
                
            </div>
        </div>
    </div>

    <div class="mb-5 card shadow">
        <div class="card-header bg-info text-white">
            <h4 class="mb-0">Rating Guide for Persuasiveness:</h4>
        </div>
        <div class="card-body p-0">
            <div class="card-group">
                <div class="card border-0">
                    <div class="card-body text-center">
                        <div class="display-4 mb-2 text-danger">1</div>
                        <h5 class="card-title">Poor</h5>
                        <p class="card-text" style="font-size: 16px;">Limited evidence with poor organization or fundamental logic flaws. Disengage with no audience awareness. </p>
                    </div>

                </div>
                <div class="card border-0">
                    <div class="card-body text-center">
                        <div class="display-4 mb-2 text-warning">2</div>
                        <h5 class="card-title">Weak</h5>
                        <p class="card-text" style="font-size: 16px;">Reasonable statements with at least one noticeable weakness. </p>
                    </div>

                </div>
                <div class="card border-0">
                    <div class="card-body text-center">
                        <div class="display-4 mb-2 text-info">3</div>
                        <h5 class="card-title">Moderate</h5>
                        <p class="card-text" style="font-size: 16px;">Reasonable statements, which provide on-topic evidence with logical flow and balanced emotional tone showing basic audience awareness</p>
                    </div>

                </div>
                <div class="card border-0">
                    <div class="card-body text-center">
                        <div class="display-4 mb-2 text-primary">4</div>
                        <h5 class="card-title">Strong</h5>
                        <p class="card-text" style="font-size: 16px;">Reasonable statements with at least one impressive shining points. </p>
                    </div>

                </div>
                <div class="card border-0">
                    <div class="card-body text-center">
                        <div class="display-4 mb-2 text-success">5</div>
                        <h5 class="card-title">Compelling</h5>
                        <p class="card-text" style="font-size: 16px;">Powerful evidence with effective counterpoints and create deep connection with audience.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>

        </div>
    </div>

    




    <div class="container" id="form_container">
        <form id="theForm" action="https://script.google.com/macros/s/AKfycbx3soqlvyNqvJUWpqUQc8wN4Hl7k5cs57awyATUshnXV7pTj4ADUF40OjmiISRZx4dc2g/exec" method="POST" onsubmit="return preventRepeatedSubmission() && checkAllRadioGroupsChecked() && confirmSubmission() && addTimestamp();;">
        <input type="hidden" name="timestamp" id="timestamp">
            <div class="form-group">
                <label for="name">Name / Prolific ID (for Prolific Participants) <sup>*</sup>  </label>
                <input class="form-control" type="text" inputmode="text" name="name" required>
            </div>
            <div class="form-group">
                <label for="mail">Email / Prolific Email (for Prolific Participants) <sup>*</sup> </label>
                <input class="form-control" type="text" inputmode="email" placeholder="account@example.com" name="mail" required>
            </div>
            <small class="form-text text-muted">* indicate required question</small>

            <br>
            <div id="motion" name="motion"><h4>Motion: Processed Foods Should Play A Larger Role In Sustainable Food Systems </h4></div>
            <br>
            
            
    <input type="hidden" id="mode" name="mode" value="mixed">
    <input type="hidden" id="version" name="version" value="0510">
    <input type="hidden" id="redirect_url" name="redirect_url" value="">

    <!-- Success Message Modal -->
    <div class="modal fade" id="successModal" tabindex="-1" role="dialog" aria-labelledby="successModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="successModalLabel">Success!</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    Your responses have been successfully submitted! Redirecting to the next questionnaire...
                </div>
            </div>
        </div>
    </div>

    <!-- Redirect Message Modal -->
    <div class="modal fade" id="redirectModal" tabindex="-1" role="dialog" aria-labelledby="redirectModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="redirectModalLabel">Redirecting...</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <p>You will be automatically redirected to the next questionnaire in <span id="countdown">5</span> seconds...</p>
                    <p>If you are not redirected automatically, <a href="#" id="manualRedirect">click here</a>.</p>
                </div>
            </div>
        </div>
    </div>

    
        <div class="card form-group question" id="question_1">
            <div class="card-header"><b>Question 1: Pre-Vote Stage</b></div>
            <div class="card-body">
                

                <!-- Sanity Check Questions -->
                <div id="sanity_check_questions" style="display: block;">
                    
                </div>

                <!-- Overall Comparison Question -->
                <div id="overall_comparison_question" style="display: block;">
                    <div class="form-group">
                        <label for="q1" style="font-weight: bold; font-size: 1.1em;">
                            Please choose your attitude towards the given motion before the debate begins.<sup>*</sup>
                        </label>
                        <div class="row align-items-center">
                            <div class="col-10 offset-1">
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" id="q1_against_2" name="q1" value="-2">
                                    <label class="form-check-label" for="q1_against">Highly Against</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" id="q1_against_1" name="q1" value="-1">
                                    <label class="form-check-label" for="q1_tie">Slightly Against</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" id="q1_tie" name="q1" value="0">
                                    <label class="form-check-label" for="q1_tie">Neutral</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" id="q1_for_1" name="q1" value="1">
                                    <label class="form-check-label" for="q1_tie">Slightly Support</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" id="q1_for_2" name="q1" value="2">
                                    <label class="form-check-label" for="q1_for">Highly Support</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            
            </div>
            <div class="card-footer">
                <b>End of Pre-Vote Stage Comparison</b>
            </div>
        </div>
    
        <div class="card form-group question" id="question_2">
            <div class="card-header"><b>Question 2: Opening Stage</b></div>
            <div class="card-body">
                
                    <div class="side-container">
                        
                            <!-- Audio Player -->
                            <div class="row align-items-center mb-2 audio">
                                <div class="col-2 text-left audio-side">
                                    <strong> For Side </strong> 
                                </div>
                                <div class="col-9">
                                    <audio controls src="https://debaterecords.s3.amazonaws.com/audio_0510/case4_2/opening_for_a.mp3" class="w-100" id="audio_1_For">
                                        Your browser does not support the audio element.
                                    </audio>
                                </div>
                            </div>

                            <!-- Transcript -->
                            <details class="transcript-details mb-3">
                                <summary class="transcript-summary p-2 bg-light rounded">
                                    <i class="fas fa-file-alt mr-2"></i>
                                    (Optional) <strong> For </strong> - Transcript
                                </summary>
                                <div class="transcript-content p-3 bg-white border rounded mt-2">In this debate, we shall argue that processed foods should play a larger role in sustainable food systems. Processed foods are defined as foods altered from their natural state through methods like canning, freezing, drying, or fortification to improve shelf life, safety, or nutritional value . Sustainable food systems are those that provide nutritious food for all while minimizing environmental degradation, ensuring economic viability, and promoting social equity .<br><br>Our judging criteria is the extent to which processed foods enhance sustainability by reducing food waste, lowering carbon footprints, and improving global food security. The team that best demonstrates these benefits through evidence-based arguments will prevail.<br><br>First, processed foods significantly reduce food waste and extend shelf life. Techniques like freezing, canning, and drying cut perishability-related waste by up to 50% compared to fresh foods . For instance, frozen vegetables have a much lower waste rate than their fresh counterparts, directly conserving resources and reducing landfill contributions. This efficiency is critical for sustainability, as food waste accounts for nearly 8% of global greenhouse gas emissions . By minimizing spoilage, processed foods help build a more resilient food supply chain.<br><br>Second, processed foods address nutrient gaps and public health crises through fortification. Enriched foods like iodized salt and fortified cereals combat malnutrition efficiently, particularly in food-insecure regions. The World Health Organization reports that fortification has reduced iodine deficiency disorders by over 70% in affected populations . This aligns with sustainable development goals by improving health outcomes without requiring additional farmland or resources. Fortified processed foods thus offer a scalable solution to global nutrition challenges.<br><br>Third, innovations in food processing lower environmental impact. Methods like high-pressure processing  use 30% less energy than traditional thermal processing while preserving nutrients . Companies like ReGrained upcycle agricultural byproducts  into nutritious snacks, reducing waste and emissions . Such advancements demonstrate that processed foods can evolve to meet ecological and nutritional needs simultaneously, making them indispensable for sustainable food systems.<br><br>In conclusion, processed foods are a vital component of sustainable food systems due to their ability to reduce waste, improve nutrition, and lower environmental impact. By leveraging technological innovations and efficient resource use, they offer practical solutions to global food challenges.<br><br></div>
                            </details>

                            <!-- Rating Section -->
                            <div class="form-group">
                                <label for="q2_1">
                                    How persuasive are these arguments in supporting <strong>For</strong> side? Rate the performance based on the following principle. <sup>*</sup>
                                </label>
                                <div class="row align-items-center">
                                    <div class="col-10 offset-1">
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" id="q2_1_poor" name="q2_1" value="1">
                                            <label class="form-check-label" for="q2_1_poor">
                                                <strong>Poor</strong>: Limited evidence with poor organization or fundamental logic flaws. Disengage with no audience awareness. 
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" id="q2_1_weak" name="q2_1" value="2">
                                            <label class="form-check-label" for="q2_1_weak">
                                                <strong>Weak</strong>: Reasonable statements with at least one noticeable weakness. 
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" id="q2_1_moderate" name="q2_1" value="3">
                                            <label class="form-check-label" for="q2_1_moderate">
                                                <strong>Moderate</strong>: Reasonable statements, which provide on-topic evidence with logical flow and balanced emotional tone showing basic audience awareness
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" id="q2_1_strong" name="q2_1" value="4">
                                            <label class="form-check-label" for="q2_1_strong">
                                                <strong>Strong</strong>: Reasonable statements with at least one impressive shining points. 
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" id="q2_1_compelling" name="q2_1" value="5">
                                            <label class="form-check-label" for="q2_1_compelling">
                                                <strong>Compelling</strong>: Powerful evidence with effective counterpoints and create deep connection with audience.
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Comment Section -->
                            <div class="form-group mt-3 mb-4">
                                <label for="q2_1_comment"> (Optional) Additional comments for <strong> For </strong> side:</label>
                                <textarea class="form-control" id="q2_1_comment" name="q2_1_comment" rows="2"></textarea>
                            </div>
                        
                    </div>

                    
                       <div class="text-center">
                           <button id="nextSideButton" class="btn btn-info btn-lg button-next-side" type="button">Proceed to next side →</button>
                       </div>
                    

                    <hr class="my-4">
                
                    <div class="side-container">
                        
                            <div class="row">
                                <!-- Left Side (Output A) -->
                                <div class="col-6 border-right">
                                    <!-- Audio Player -->
                                    
                                    <h5 class="text-center mb-3">Output A - <strong>Against</strong> Side</h5>
                                        <div class="audio-section mb-4">
                                            <div class="audio-player mb-3">
                                                <audio controls src="https://debaterecords.s3.amazonaws.com/audio_0510/case4_2/opening_against_b.mp3" class="w-100" id="audio_a_2_Against">
                                                    Your browser does not support the audio element.
                                                </audio>
                                            </div>

                                            <!-- Transcript -->
                                            <details class="transcript-details mb-3">
                                                <summary class="transcript-summary p-2 bg-light rounded">
                                                    <i class="fas fa-file-alt mr-2"></i>
                                                    (Optional) <strong>Against</strong> - Transcript A
                                                </summary>
                                                <div class="transcript-content p-3 bg-white border rounded mt-2">Ladies and gentlemen, today we oppose the idea that processed foods should play a larger role in sustainable food systems. Sustainability isn’t just about reducing waste—it’s about balancing environmental, health, and economic needs. Processed foods fail this test on all fronts.  <br><br>First, let’s address the environmental impact. The other side claims processed foods cut waste, but they ignore the staggering carbon footprint of industrial processing. Research from *Nature* in 2022 reveals that freezing vegetables increases emissions by 30% compared to seasonal fresh produce. The *World Resources Institute* confirms this in their 2022 study, showing that processing stages—from production to packaging—account for 19% to 26% of the sector’s total environmental harm. Even so-called "green" technologies like high-pressure processing rely on non-renewable energy and centralized supply chains, which small farms can’t access. This isn’t sustainability—it’s a band-aid on a broken system. Fresh, local foods with shorter supply chains are the real solution. Take Vermont, where farm cooperatives supply 40% of school lunches—proof that local systems can scale effectively.  <br><br>Next, health. While opponents tout fortified foods, the *World Health Organization* warns that ultra-processed foods drive 60% of child obesity cases and are linked to a 41% higher risk of depression. A 2023 study in *JAMA* exposes how processed foods are engineered to be addictive, targeting low-income communities with high levels of sugar, salt, and unhealthy fats. These populations face 7 times the risk of early-life stroke, as reported by *PMC* in 2018. Fortification doesn’t undo this harm; it’s a stopgap—like giving vitamins to someone eating junk food. We need systemic change, not pills in cereal. Real sustainability means nourishing people with whole foods, not marketing gimmicks.  <br><br>Finally, economics. Processed foods dominate because multinationals control 75% of sales, as *Oxfam* reported in 2021. Small farmers can’t compete with agribusiness monopolies that prioritize profit over people. For example, community-supported agriculture programs in countries like France have reduced waste by 23% while supporting local economies, according to a 2022 study in *ScienceDirect*. In Iowa, similar CSAs cut waste by 18%, demonstrating that local models work even in large agricultural states. Yet these systems are sidelined by a system favoring cheap, mass-produced snacks. The diabetes epidemic fueled by processed foods costs the U.S. $327 billion annually—money that could rebuild local food systems if we diverted just 10% of these funds to support small farms, as the *CDC* noted in 2020. True sustainability empowers communities, not corporations.  <br><br>In short, processed foods aren’t the future. They’re a costly shortcut that harms the planet, our health, and local economies. Next time you shop, ask: Is this food nourishing my community—or a corporation’s profits? Vote with your fork. Let’s invest in real solutions: decentralized farms, honest nutrition, and food systems that work for everyone. Thank you.<br><br>
                                                </div>
                                            </details>

                                            <!-- Rating Section -->
                                            <div class="form-group">
                                            <label for="q2_2_a">
                                                How persuasive is <strong>Output A</strong> in supporting <strong>Against</strong> side? Rate the performance based on the following principle. <sup>*</sup>
                                            </label>
                                            <div class="row align-items-center">
                                                <div class="col-10 offset-1">
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="radio" id="q2_2_a_poor" name="q2_2_a" value="1">
                                                        <label class="form-check-label" for="q2_2_a_poor">
                                                            <strong>Poor</strong>: Limited evidence with poor organization or fundamental logic flaws. Disengage with no audience awareness. 
                                                        </label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="radio" id="q2_2_a_weak" name="q2_2_a" value="2">
                                                        <label class="form-check-label" for="q2_2_a_weak">
                                                            <strong>Weak</strong>: Reasonable statements with at least one noticeable weakness. 
                                                        </label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="radio" id="q2_2_a_moderate" name="q2_2_a" value="3">
                                                        <label class="form-check-label" for="q2_2_a_moderate">
                                                            <strong>Moderate</strong>: Reasonable statements, which provide on-topic evidence with logical flow and balanced emotional tone showing basic audience awareness
                                                        </label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="radio" id="q2_2_a_strong" name="q2_2_a" value="4">
                                                        <label class="form-check-label" for="q2_2_a_strong">
                                                            <strong>Strong</strong>: Reasonable statements with at least one impressive shining points. 
                                                        </label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="radio" id="q2_2_a_compelling" name="q2_2_a" value="5">
                                                        <label class="form-check-label" for="q2_2_a_compelling">
                                                            <strong>Compelling</strong>: Powerful evidence with effective counterpoints and create deep connection with audience.
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Comment Section -->
                                        <div class="form-group mt-3 mb-4">
                                            <label for="q2_2_comment_a"> (Optional) Additional comments for <strong> Output A's Against </strong> side:</label>
                                            <textarea class="form-control" id="q2_2_comment_a" name="q2_2_comment_a" rows="2"></textarea>
                                        </div>
                                        </div>
                                        
                                    
                                </div>

                                <!-- Right Side (Output B) -->
                                <div class="col-6">
                                    <!-- Audio Player -->
                                    <h5 class="text-center mb-3">Output B - <strong>Against</strong> Side </h5>
                                        <div class="audio-section mb-4">
                                            <div class="audio-player mb-3">
                                                <audio controls src="https://debaterecords.s3.amazonaws.com/audio_0510/case4_2/opening_against_a.mp3" class="w-100" id="audio_b_2_Against">
                                                    Your browser does not support the audio element.
                                                </audio>
                                            </div>

                                            <!-- Transcript -->
                                            <details class="transcript-details mb-3">
                                                <summary class="transcript-summary p-2 bg-light rounded">
                                                    <i class="fas fa-file-alt mr-2"></i>
                                                    (Optional) <strong>Against</strong> Transcript B
                                                </summary>
                                                <div class="transcript-content p-3 bg-white border rounded mt-2">In this debate, we shall argue that processed foods should not play a larger role in sustainable food systems. Processed foods are defined as foods altered from their natural state through methods like canning, freezing, or adding preservatives, often containing high levels of salt, sugar, and unhealthy fats. Sustainable food systems must provide healthy food while maintaining ecosystems for future generations with minimal environmental and social harm.<br><br>Our judging criteria is whether increasing processed foods in food systems supports or undermines public health and environmental sustainability. A sustainable food system must prioritize nutritional quality, ecological preservation, and long-term food security.<br><br>First, processed foods contribute to significant health risks that undermine sustainable food systems. Studies show ultra-processed foods are linked to a 9% increase in mortality risk for every 10% increase in calories consumed from these foods . Research indicates they are associated with higher risks of obesity, type 2 diabetes, cardiovascular diseases, and 30+ other health conditions . For instance, a Tufts University study found that ultra-processed foods account for 57% of Americans' calorie intake while providing minimal nutritional value . This demonstrates how processed foods directly contradict the health pillar of sustainability by increasing chronic disease burdens.<br><br>Second, processed food production has severe environmental costs that counteract sustainability goals. The food sector generates 26% of global greenhouse gas emissions, with ultra-processed foods contributing disproportionately through energy-intensive manufacturing and packaging . A Soil Association report found that processed food production drives deforestation , generates non-biodegradable packaging waste, and reduces biodiversity through monoculture farming . For example, processed meat production emits 5 times more greenhouse gases than plant-based alternatives per kilogram . These impacts make processed foods incompatible with environmental sustainability objectives.<br><br>Third, whole, local and seasonal foods provide superior alternatives for sustainable food systems. Research shows locally-sourced whole foods reduce food miles by 50-80% compared to processed alternatives while maintaining higher nutrient density . A Lancet Planetary Health study demonstrated that shifting to plant-rich, minimally processed diets could reduce global mortality by 10-20% and food system emissions by 29-70% . Community-supported agriculture models have shown 30% higher farmer incomes and 40% lower energy use compared to industrial food systems . These solutions prove that reducing processed food reliance aligns better with sustainable food system principles.<br><br>In conclusion, the health risks, environmental harms, and availability of better alternatives demonstrate that processed foods should not expand their role in sustainable food systems. True sustainability requires prioritizing whole, minimally processed foods that benefit both human health and planetary ecosystems.<br><br>
                                                </div>
                                            </details>

                                            <!-- Rating Section -->
                                            <div class="form-group">
                                            <label for="q2_2_b">
                                                How persuasive is <strong>Output B</strong> in supporting <strong>Against</strong> side? Rate the performance based on the following principle. <sup>*</sup>
                                            </label>
                                            <div class="row align-items-center">
                                                <div class="col-10 offset-1">
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="radio" id="q2_2_b_poor" name="q2_2_b" value="1">
                                                        <label class="form-check-label" for="q2_2_b_poor">
                                                            <strong>Poor</strong>: Limited evidence with poor organization or fundamental logic flaws. Disengage with no audience awareness. 
                                                        </label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="radio" id="q2_2_b_weak" name="q2_2_b" value="2">
                                                        <label class="form-check-label" for="q2_2_b_weak">
                                                            <strong>Weak</strong>: Reasonable statements with at least one noticeable weaknesses. 
                                                        </label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="radio" id="q2_2_b_moderate" name="q2_2_b" value="3">
                                                        <label class="form-check-label" for="q2_2_b_moderate">
                                                            <strong>Moderate</strong>: Reasonable statements, which provide on-topic evidence with logical flow and balanced emotional tone showing basic audience awareness
                                                        </label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="radio" id="q2_2_b_strong" name="q2_2_b" value="4">
                                                        <label class="form-check-label" for="q2_2_b_strong">
                                                            <strong>Strong</strong>: Reasonable statements with at least one impressive shining points. 
                                                        </label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="radio" id="q2_2_b_compelling" name="q2_2_b" value="5">
                                                        <label class="form-check-label" for="q2_2_b_compelling">
                                                            <strong>Compelling</strong>: Powerful evidence with effective counterpoints and create deep connection with audience.
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Comment Section -->
                                        <div class="form-group mt-3 mb-4">
                                            <label for="q2_2_comment_b"> (Optional) Additional comments for <strong> Output B's Against </strong> side:</label>
                                            <textarea class="form-control" id="q2_2_comment_b" name="q2_2_comment_b" rows="2"></textarea>
                                        </div>
                                        </div>
                                        
                                </div>
                            </div>

                            <div class="row">
                                <div class="form-group">
                                    <label for="q2" style="font-weight: bold; font-size: 1.1em;" class="col-12 offset-4">
                                        Which output do you find more effective overall?<sup>*</sup>
                                    </label>
                                    <div class="row justify-content-center">
                                        <div class="col-12 offset-8">
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="q2_2" value="-1" id="q2_2_slightly_a">
                                                <label class="form-check-label" for="q2_2_a"> Prefer Output A</label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="q2_2" value="0" id="q2_2_equal">
                                                <label class="form-check-label" for="q2_2_equal">Both outputs are equally effective</label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="q2_2" value="1" id="q2_2_slightly_b">
                                                <label class="form-check-label" for="q2_2_b">Prefer Output B</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>


                        
                    </div>

                    

                    <hr class="my-4">
                

                <!-- Sanity Check Questions -->
                <div id="sanity_check_questions" style="display: block;">
                    
                        
                        
                            <div class="form-group mt-3 mb-4">
                                <label for="q2_sanity">Which claim is proposed by <strong>Output A's</strong> <strong>Against</strong> side as its <strong>second</strong> main claim during the opening statement? If multiple options apply, please choose the best one. <sup>*</sup></label>
                                <div class="row align-items-center">
                                    <div class="col-10 offset-1">
                                        
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" 
                                                    id="q2_sanity_option_0"
                                                    name="q2_sanity"
                                                    value="0">
                                                <label class="form-check-label" for="q2_sanity_option_0">
                                                    Processed foods can be fortified with vitamins and minerals to combat malnutrition.
                                                </label>
                                            </div>
                                        
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" 
                                                    id="q2_sanity_option_1"
                                                    name="q2_sanity"
                                                    value="1">
                                                <label class="form-check-label" for="q2_sanity_option_1">
                                                    The marketing of processed foods targets vulnerable populations.
                                                </label>
                                            </div>
                                        
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" 
                                                    id="q2_sanity_option_2"
                                                    name="q2_sanity"
                                                    value="2">
                                                <label class="form-check-label" for="q2_sanity_option_2">
                                                    Effective Altruism's metrics-driven approach overlooks crucial local contexts that determine real impact
                                                </label>
                                            </div>
                                        
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" 
                                                    id="q2_sanity_option_3"
                                                    name="q2_sanity"
                                                    value="3">
                                                <label class="form-check-label" for="q2_sanity_option_3">
                                                    Packaging from processed foods contributes to plastic pollution.
                                                </label>
                                            </div>
                                        
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" 
                                                    id="q2_sanity_option_4"
                                                    name="q2_sanity"
                                                    value="4">
                                                <label class="form-check-label" for="q2_sanity_option_4">
                                                    None of the above
                                                </label>
                                            </div>
                                        
                                    </div>
                                </div>
                            </div>
                            <input type="hidden" id="q2_sanity_answer" name="q2_sanity_answer" value="1">
                        
                    
                </div>

                <!-- Overall Comparison Question -->
                <div id="overall_comparison_question" style="display: block;">
                    <div class="form-group">
                        <label for="q2" style="font-weight: bold; font-size: 1.1em;">
                            After listening to the two statements in Opening stage, please choose your attitude towards the given motion (Processed Foods Should Play A Larger Role In Sustainable Food Systems) now<sup>*</sup>
                        </label>
                        <div class="row align-items-center">
                            <div class="col-10 offset-1">
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" id="q2_against_2" name="q2" value="-2">
                                    <label class="form-check-label" for="q2_against">Highly Against</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" id="q2_against_1" name="q2" value="-1">
                                    <label class="form-check-label" for="q2_tie">Slightly Against</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" id="q2_tie" name="q2" value="0">
                                    <label class="form-check-label" for="q2_tie">Neutral</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" id="q2_for_1" name="q2" value="1">
                                    <label class="form-check-label" for="q2_tie">Slightly Support</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" id="q2_for_2" name="q2" value="2">
                                    <label class="form-check-label" for="q2_for">Highly Support</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            
            </div>
            <div class="card-footer">
                <b>End of Opening Stage Comparison</b>
            </div>
        </div>
    

    <!-- Additional Questions -->
    
        <div class="card form-group question" id="question_3">
            <div class="card-header">
                <b>(Optional) Question 5: Which factors were most crucial in your assessment?</b>
            </div>
            <div class="card-body">
                
                    <div class="form-group">
                        <label for="q5"></label>
                        <textarea class="form-control" name="q5" rows="3"></textarea>
                    </div>
                
            </div>
            <div class="card-footer">
                <b>Additional Question 1 / 2</b>
            </div>
        </div>
    
        <div class="card form-group question" id="question_4">
            <div class="card-header">
                <b>(Optional) Question 6: How long did you spend on this whole evaluation process (including reading the motion, listening to the debate, and answering the questions)?</b>
            </div>
            <div class="card-body">
                
                    <div class="form-group">
                        <label for="q6"></label>
                        <textarea class="form-control" name="q6" rows="3"></textarea>
                    </div>
                
            </div>
            <div class="card-footer">
                <b>Additional Question 2 / 2</b>
            </div>
        </div>
    

            <input type="text" name="formid" value="4_2(T1_n1)" hidden>
            <input type="text" name="thank" value="Thanks. If you are a Prolific participant, your code is CMF26Y29" hidden>
            <div class="button-row" style="display: flex; justify-content: space-between; align-items: center; margin: 20px 0;">
                <div class="navigation-buttons">
                    
    <button id="previousPageButton" class="btn btn-info btn-lg" type="button">← Go Back</button>
    <button id="nextPageButton" class="btn btn-info btn-lg" type="button">Continue →</button>

                </div>
                <div id="submitButtonContainer" style="display: none;">
                    <input class="btn btn-info btn-lg" type="submit" value="Submit this✓" id="submitBtn">
                </div>
            </div>
            <p class="text-muted">
                <small>If you find that you can't submit the results, please check back to see if you have filled in your name and if you have answered every required question with <sup>*</sup>. Thank you.</small>
            </p>
        </form>
    </div>

    <div class="container" style="padding-top: 60px;">
        <p class="text-center text-muted">&copy; CMU Debate Team</p>
    </div>

    <!-- Replace the jQuery slim version with the full version -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" 
        integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" 
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.1/js/bootstrap.min.js" 
        integrity="sha384-XEerZL0cuoUbHE4nZReLT7nx9gQrQreJekYhJD9WNWhH8nEW+0c5qq7aIo2Wl30J" 
        crossorigin="anonymous"></script>

    <script type="text/javascript">
        // Define the beforeunload handler as a named function so it can be removed
        function handleBeforeUnload(e) {
            if (!document.getElementById('submitBtn').disabled) {
                // Cancel the event
                e.preventDefault();
                // Chrome requires returnValue to be set
                e.returnValue = '';
            }
        }

        // Add the beforeunload event listener
        window.addEventListener('beforeunload', handleBeforeUnload);

        // Function to disable the beforeunload warning
        function disableBeforeUnload() {
            window.removeEventListener('beforeunload', handleBeforeUnload);
        }

        function confirmSubmission() {
            return confirm('Are you sure you want to submit your results?');
        }

        function preventRepeatedSubmission() {
            document.getElementById('submitBtn').disabled = true;
            setTimeout("submitBtn.disabled=false;", 50);
            return true;
        };
        function addTimestamp() {
            // Get current timestamp in milliseconds
            const currentTimestamp = Date.now();
            const dateObject = new Date(currentTimestamp);
            const readableTimestamp = dateObject.toISOString().replace("T", " ").substring(0, 19);

            // Set the value of the hidden input field to the current timestamp
            document.getElementById("timestamp").value = readableTimestamp;
            return true;
        }
        function checkAllRadioGroupsChecked() {
            const radioGroups = document.querySelectorAll('.form-check-input[type="radio"]');
            const radioNames = new Set();
            radioGroups.forEach(input => radioNames.add(input.name));
            for (let name of radioNames) {
                const group = document.querySelectorAll(`input[name="${name}"]`);
                const isChecked = Array.from(group).some(input => input.checked);
                if (!isChecked) {
                    alert('Please ensure you have voted for all required questions by selecting an option in each group. You can use `Previous Question` to check your answers.');
                    return false;
                }
            }
            return true;
        }
    </script>

    
    
    <script>
    // Function to handle consent acceptance
    function acceptConsent() {
        const checkboxes = document.querySelectorAll('#consentModal input[type="checkbox"]');
        let allChecked = true;

        checkboxes.forEach(checkbox => {
            if (!checkbox.checked) {
                allChecked = false;
            }
        });

        if (allChecked) {
            $('#consentModal').modal('hide');
            // Additional logic for acceptance can be added here
        } else {
            alert('Please ensure all checkboxes are marked before proceeding.');
        }
    }

    // Function to handle consent rejection
    function rejectConsent() {
        if (!confirm('You must accept the consent form to proceed. Click "OK" to stay on this page or "Cancel" to be redirected.')) {
            window.location.href = '/debate-evaluation/thanks'; // Redirect to the "/thanks" page under the baseurl
        }
    }

    // Show the consent modal on page load
    $(document).ready(function() {
        $('#consentModal').modal({
            backdrop: 'static',
            keyboard: false
        });
        $('#consentModal').modal('show');
    });


</script>

    <script>
        // Call this function when the page loads
        document.addEventListener('DOMContentLoaded', function() {
            setupAudioSideNavigation();
            
            // Add form submission handler
            document.getElementById('theForm').addEventListener('submit', function(e) {
                const redirectUrl = document.getElementById('redirect_url').value;
                if (redirectUrl) {
                    // Show loading indicator
                    const submitBtn = document.getElementById('submitBtn');
                    submitBtn.disabled = true;
                    submitBtn.value = 'Submitting...';
                    
                    // Submit the form first
                    const form = this;
                    const formData = new FormData(form);
                    
                    // Prevent the default form submission
                    e.preventDefault();
                    
                    fetch(form.action, {
                        method: 'POST',
                        body: formData
                    })
                    .then(response => {
                        if (response.ok) {
                            // Show success modal
                            $('#successModal').modal('show');
                            
                            // Disable the beforeunload warning
                            disableBeforeUnload();
                            
                            // Show redirect modal after a short delay
                            setTimeout(() => {
                                $('#successModal').modal('hide');
                                $('#redirectModal').modal('show');
                                
                                // Set up manual redirect link
                                document.getElementById('manualRedirect').href = redirectUrl;
                                
                                // Start countdown
                                let countdown = 5;
                                const countdownInterval = setInterval(() => {
                                    countdown--;
                                    document.getElementById('countdown').textContent = countdown;
                                    if (countdown <= 0) {
                                        clearInterval(countdownInterval);
                                        $('#redirectModal').modal('hide');
                                        window.location.href = redirectUrl;
                                    }
                                }, 1000);
                            }, 2000);
                        } else {
                            // If submission failed, show error
                            alert('Form submission failed. Please try again.');
                            submitBtn.disabled = false;
                            submitBtn.value = 'Submit All✓';
                        }
                    })
                    .catch(error => {
                        console.error('Error:', error);
                        alert('An error occurred while submitting the form. Please try again.');
                        submitBtn.disabled = false;
                        submitBtn.value = 'Submit All✓';
                    });
                }
            });
        });

        let currentQuestionIndex = 0;
        const questions = document.querySelectorAll('.question');
        const nextPageButton = document.getElementById('nextPageButton');

        function showQuestion(index) {
            questions.forEach((question, i) => {
                question.style.display = i <= index ? 'block' : 'none';
            });
            
            // Show submit button only when all questions are shown
            const submitButtonContainer = document.getElementById('submitButtonContainer');
            if (index === questions.length - 1) {
                submitButtonContainer.style.display = 'block';
            } else {
                submitButtonContainer.style.display = 'none';
            }
        }

        const audios = document.querySelectorAll('audio');
        audios.forEach((function(audioElement) {
            audioElement.dataset.played = "false"; // Initial state

            audioElement.addEventListener('ended', function() {
                console.log('Audio has played:', this.src);
                this.dataset.played = "true"; // Mark as played
            });
        }));

        nextPageButton.addEventListener('click', function() {
            // Get all currently visible questions
            const currentQuestions = document.querySelectorAll('.question[style*="display: block"]');
            
            let allValidAudio = true;
            let allValidQuestion = true;
            let invalidAudios = [];
            let invalidQuestions = [];

            // Check each visible question
            currentQuestions.forEach(currentQuestion => {
                // Check if all audios have been played
                const currentaudio = currentQuestion.querySelectorAll('audio');
                currentaudio.forEach(audioElement => {
                    if (audioElement.dataset.played === "false") {
                        allValidAudio = false;
                        const audioLabel = audioElement.closest(".audio") ? 
                            audioElement.closest(".audio").querySelector('.audio-side').innerText :
                            audioElement.id;
                        invalidAudios.push(audioLabel + ' (Audio not played to the end)');
                    }
                });

                // check all questions have been answered
                const radioGroups = currentQuestion.querySelectorAll('.form-check-input[type="radio"]');
                const radioNames = new Set();
                radioGroups.forEach(input => radioNames.add(input.name));
                radioNames.forEach(name => {
                    const group = currentQuestion.querySelectorAll(`input[name="${name}"]`);
                    const isChecked = Array.from(group).some(input => input.checked);
                    if (!isChecked) {
                        allValidQuestion = false;
                        const questionLabel = group[0].closest('.form-group').querySelector('label').innerText;
                        invalidQuestions.push(questionLabel);
                    }
                });
            });
            

            if (!allValidAudio) {
                alert('Please listen to the following audio before voting (for both sides). \n => ' + invalidAudios.join('\n => '));
            } else if (!allValidQuestion) {
                alert('Please vote for the following questions (for both sides). You need to choose one most suitable option. \n => ' + invalidQuestions.join('\n => '));
            } else {
                if (currentQuestionIndex < questions.length - 1) {
                    currentQuestionIndex++;
                    showQuestion(currentQuestionIndex);
                    /* document.getElementById('form_container').scrollIntoView({ behavior: 'smooth' }); */
                } else {
                    alert('You have completed all questions. Remember to click "Submit Results" to upload the results. If success, it will show "Thanks" after submission.');
                }
            }
        });

        previousPageButton.addEventListener('click', function() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                showQuestion(currentQuestionIndex);
            } else {
                alert('This is the first question.');
            }
        });

        // Initialize the first question
        showQuestion(currentQuestionIndex);

        // Add a function to handle navigation between audio sides
        function setupAudioSideNavigation() {            
            // Add "Other Side" button after each question's navigation
            questions.forEach(question => {
                const audioContainers = question.querySelectorAll('.side-container');
                if (audioContainers.length > 1) {                
                    // Initially show only the first audio
                    audioContainers.forEach((container, index) => {
                        if (index === 0) {
                            container.style.display = 'block';
                        } else {
                            container.style.display = 'none';
                        }
                    });
                    
                    // Set up the click handler for the Other Side button
                    let currentAudioIndex = 0;
                    const otherSideBtn = question.querySelectorAll('.button-next-side');
                    const sanityCheckDiv = question.querySelector('#sanity_check_questions');
                    const overallComparisonDiv = question.querySelector('#overall_comparison_question');
                    otherSideBtn.forEach(button => {
                        button.addEventListener('click', function() {
                            currentAudioIndex = (currentAudioIndex + 1) % audioContainers.length;
                            
                            // Show the next audio
                            audioContainers[currentAudioIndex].style.display = 'block';
                            button.style.display = 'none';

                            // Show the sanity check questions
                            sanityCheckDiv.style.display = 'block';

                            // Show the overall comparison question
                            // overallComparisonDiv.style.display = 'block';


                        });
                    });
                }
            });
        }

    </script>

</body>

</html>